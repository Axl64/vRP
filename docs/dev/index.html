<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<title>vRP Developer Documentation</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #222222; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { tab-size: 4; word-wrap: anywhere; -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; }

table { word-wrap: normal; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.stretch { width: 100%; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

:not(pre).nobreak { word-wrap: normal; }
:not(pre).nowrap { white-space: nowrap; }
:not(pre).pre-wrap { white-space: pre-wrap; }

:not(pre):not([class^=L]) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; line-height: inherit; }

pre { color: black; font-family: monospace, serif; line-height: 1.4; }
pre code, pre pre { color: inherit; font-size: inherit; line-height: inherit; }
pre > code { display: block; }

pre.nowrap, pre.nowrap pre { white-space: pre; word-wrap: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #555555; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: #222222; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: none; background: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

details, .audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

details > summary:first-of-type { cursor: pointer; display: list-item; outline: none; margin-bottom: 0.75em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock.fit-content > caption.title { white-space: nowrap; width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: 1.21875em; line-height: 1.6; color: black; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; word-wrap: anywhere; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d4d4d4; margin-bottom: 1.25em; padding: 1.25em; background: #ededed; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock > .content > pre { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; overflow-x: auto; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
@media only screen and (min-width: 768px) { .literalblock pre, .listingblock > .content > pre { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .listingblock > .content > pre { font-size: 1em; } }

.literalblock pre, .listingblock > .content > pre:not(.highlight), .listingblock > .content > pre[class="highlight"], .listingblock > .content > pre[class^="highlight "] { background: #eeeeee; }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: inherit; opacity: 0.5; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: inherit; opacity: 0.5; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.prettyprint { background: #eeeeee; }

pre.prettyprint .linenums { line-height: 1.4; margin-left: 2em; }

pre.prettyprint li { background: none; list-style-type: inherit; padding-left: 0; }

pre.prettyprint li code[data-lang]:before { opacity: 1; }

pre.prettyprint li:not(:first-child) code[data-lang]:before { display: none; }

table.linenotable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }
table.linenotable td[class] { color: inherit; vertical-align: top; padding: 0; line-height: inherit; white-space: normal; }
table.linenotable td.code { padding-left: 0.75em; }
table.linenotable td.linenos { border-right: 1px solid currentColor; opacity: 0.35; padding-right: 0.5em; }

pre.pygments .lineno { border-right: 1px solid currentColor; opacity: 0.35; display: inline-block; margin-right: 0.75em; }
pre.pygments .lineno:before { content: ""; margin-right: -0.125em; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock:not(.excerpt) > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.75em; margin-right: 0.5ex; text-align: right; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #555555; }

.quoteblock.abstract blockquote:before, .quoteblock.excerpt blockquote:before, .quoteblock .quoteblock blockquote:before { display: none; }
.quoteblock.abstract blockquote, .quoteblock.abstract p, .quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { line-height: 1.6; word-spacing: 0; }
.quoteblock.abstract { margin: 0 1em 1.25em 1em; display: block; }
.quoteblock.abstract > .title { margin: 0 0 0.375em 0; font-size: 1.15em; text-align: center; }
.quoteblock.excerpt > blockquote, .quoteblock .quoteblock { padding: 0 0 0.25em 1em; border-left: 0.25em solid #dddddd; }
.quoteblock.excerpt, .quoteblock .quoteblock { margin-left: 0; }
.quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { color: inherit; font-size: 1.0625rem; }
.quoteblock.excerpt .attribution, .quoteblock .quoteblock .attribution { color: inherit; font-size: 0.85rem; text-align: left; margin-right: 0; }

p.tableblock:last-child { margin-bottom: 0; }

td.tableblock > .content { margin-bottom: 1.25em; word-wrap: anywhere; }
td.tableblock > .content > :last-child { margin-bottom: -1.25em; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all > * > tr > * { border-width: 1px; }

table.grid-cols > * > tr > * { border-width: 0 1px; }

table.grid-rows > * > tr > * { border-width: 1px 0; }

table.frame-all { border-width: 1px; }

table.frame-ends { border-width: 1px 0; }

table.frame-sides { border-width: 0 1px; }

table.frame-none > colgroup + * > :first-child > *, table.frame-sides > colgroup + * > :first-child > * { border-top-width: 0; }

table.frame-none > :last-child > :last-child > *, table.frame-sides > :last-child > :last-child > * { border-bottom-width: 0; }

table.frame-none > * > tr > :first-child, table.frame-ends > * > tr > :first-child { border-left-width: 0; }

table.frame-none > * > tr > :last-child, table.frame-ends > * > tr > :last-child { border-right-width: 0; }

table.stripes-all tr, table.stripes-odd tr:nth-of-type(odd), table.stripes-even tr:nth-of-type(even), table.stripes-hover tr:hover { background: #f9f9f9; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist > li > p:first-child { margin-left: -1em; }
ul.checklist > li > p:first-child > .fa-square-o:first-child, ul.checklist > li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }
ul.checklist > li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.625em -1.25em; }

ul.inline > li { margin-left: 1.25em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

td.hdlist2 { word-wrap: anywhere; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist td:not([class]):first-child { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist td:not([class]):first-child img { max-width: none; }
.colist td:not([class]):last-child { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 50%; border-radius: 50%; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>vRP Developer Documentation</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_concepts">Concepts</a>
<ul class="sectlevel2">
<li><a href="#_oop">OOP</a></li>
<li><a href="#_asynchronous">Asynchronous</a></li>
<li><a href="#_db_driver">DB driver</a></li>
<li><a href="#_proxy_and_tunnel">Proxy and Tunnel</a></li>
<li><a href="#_data">Data</a></li>
<li><a href="#_script_loading">Script loading</a></li>
<li><a href="#_extension">Extension</a></li>
<li><a href="#_profiler">Profiler</a></li>
</ul>
</li>
<li><a href="#_general_api">General API</a>
<ul class="sectlevel2">
<li><a href="#_utils">utils</a></li>
<li><a href="#_proxy_and_tunnel_3">Proxy and Tunnel</a></li>
<li><a href="#_dbdriver">DBDriver</a></li>
<li><a href="#_extension_2">Extension</a></li>
<li><a href="#_user_2">User</a></li>
<li><a href="#_vrp">vRP</a></li>
</ul>
</li>
<li><a href="#_modules">Modules</a>
<ul class="sectlevel2">
<li><a href="#_admin">Admin</a></li>
<li><a href="#_aptitude">Aptitude</a></li>
<li><a href="#_atm">ATM</a></li>
<li><a href="#_audio">Audio</a></li>
<li><a href="#_base">Base</a></li>
<li><a href="#_business">Business</a></li>
<li><a href="#_cloak">Cloak</a></li>
<li><a href="#_edible">Edible</a></li>
<li><a href="#_emotes">Emotes</a></li>
<li><a href="#_garage">Garage</a></li>
<li><a href="#_group">Group</a></li>
<li><a href="#_gui">GUI</a></li>
<li><a href="#_hiddentransformer">HiddenTransformer</a></li>
<li><a href="#_home">Home</a></li>
<li><a href="#_home_components">home_components</a></li>
<li><a href="#_identity">Identity</a></li>
<li><a href="#_inventory">Inventory</a></li>
<li><a href="#_login">Login</a></li>
<li><a href="#_map">Map</a></li>
<li><a href="#_mission">Mission</a></li>
<li><a href="#_money">Money</a></li>
<li><a href="#_pedblacklist">PedBlacklist</a></li>
<li><a href="#_phone">Phone</a></li>
<li><a href="#_playerstate">PlayerState</a></li>
<li><a href="#_police">Police</a></li>
<li><a href="#_radio_2">Radio</a></li>
<li><a href="#_shop">Shop</a></li>
<li><a href="#_skinshop">SkinShop</a></li>
<li><a href="#_survival">Survival</a></li>
<li><a href="#_transformer_2">Transformer</a></li>
<li><a href="#_vehblacklist">VehBlacklist</a></li>
<li><a href="#_warp">Warp</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_concepts">Concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_oop">OOP</h3>
<div class="paragraph">
<p>vRP 2 Object-Oriented Programming uses the <a href="https://github.com/ImagicTheCat/Luaoop">Luaoop</a> library.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By using OOP, instead of loading resources communicating with vRP through Proxy, extensions can directly be loaded into the vRP resource context. Each extension keeps its data and is able to access other extensions data and methods, making extending vRP easier, more powerful (we can access stuff even if not exposed) and with less overhead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_asynchronous">Asynchronous</h3>
<div class="paragraph">
<p>vRP 2 extensively uses asynchronous tasks in a transparent way using coroutines, some functions may not return immediately (or never).</p>
</div>
</div>
<div class="sect2">
<h3 id="_db_driver">DB driver</h3>
<div class="paragraph">
<p>A DB driver is a class handling MySQL queries. When the vRP MySQL API is used, the DB driver methods are called to process the queries. If the DB driver is not loaded yet, queries will be cached until loaded.</p>
</div>
</div>
<div class="sect2">
<h3 id="_proxy_and_tunnel">Proxy and Tunnel</h3>
<div class="paragraph">
<p>The proxy library is used to call other resources functions through a proxy event.</p>
</div>
<div class="paragraph">
<p>The idea behind tunnel is to easily access any exposed server function from any client resource, and to access any exposed client function from any server resource.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Good practice is to get the interface once and set it as a global. If we want to get multiple times the same interface from the same resource, we need to specify a unique identifier (the name of the resource + a unique id for each one).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Tunnel and Proxy are blocking calls in the current coroutine until the values are returned, to bypass this behaviour, especially for the Tunnel to optimize speed (ping latency of each call), use <code>_</code> as a prefix for the function name (Proxy/Tunnel interfaces should not have functions starting with <code>_</code>). This will discard the returned values, but if we still need them, we can make normal calls in a new Citizen thread with <code>Citizen.CreateThreadNow</code> or <code>async</code> to have non-blocking code.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Also remember that Citizen event handlers (used by Proxy and Tunnel) may not work while loading the resource; to use the Proxy at loading time, we will need to delay it with <code>Citizen.CreateThread</code> or a <code>SetTimeout</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_data">Data</h3>
<div class="sect3">
<h4 id="_multi_server_and_character">Multi-server and character</h4>
<div class="paragraph">
<p>vRP 2 has multi-server and multi-character support. Each server has a string identifier.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Players can use another character after spawned, thus extensions should properly handle character load/unload events and check if the character is ready.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_key_value_stores">Key-value stores</h4>
<div class="paragraph">
<p>vRP provides a key-value API to store custom binary data in the database. A string key is associated to a binary value (ex: a Lua string). The key is a <code>VARCHAR(100)</code> and the value a <code>BLOB</code> (probably 65535 bytes).</p>
</div>
<div class="hdlist">
<div class="title">Types</div>
<table>
<tr>
<td class="hdlist1">
global
</td>
<td class="hdlist2">
<p>GData</p>
</td>
</tr>
<tr>
<td class="hdlist1">
per server
</td>
<td class="hdlist2">
<p>SData</p>
</td>
</tr>
<tr>
<td class="hdlist1">
per user
</td>
<td class="hdlist2">
<p>UData</p>
</td>
</tr>
<tr>
<td class="hdlist1">
per character
</td>
<td class="hdlist2">
<p>CData</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
vRP core tables, as core files, should not be modified for extensions compatibility. New tables and queries should be created if the key-value system is not powerful enough.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_core">Core</h4>
<div class="paragraph">
<p>vRP core modules data may be stored in specific MySQL tables or using the key-value stores. For the latter, the keys will probably be prefixed by <code>vRP</code> and the binary data will use the <a href="https://msgpack.org">MessagePack</a> format.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_script_loading">Script loading</h3>
<div class="paragraph">
<p>To use vRP 2, a script must be loaded in the vRP resource context of a specific side.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- include `@vrp/lib/utils.lua` in `__resource.lua` (for the targeted side)

local Proxy = module("vrp", "lib/Proxy")
local vRP = Proxy.getInterface("vRP")

vRP.loadScript("my_resource", "vrp") -- load "my_resource/vrp.lua"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The content of <code>vrp.lua</code> is now executed in the vRP context and can now use the API.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>vRP.loadScript()</code> is a proxy to call <code>module()</code> in the vRP context.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_extension">Extension</h3>
<div class="paragraph">
<p>An extension is a class extending vRP.</p>
</div>
<div class="paragraph">
<p>Two versions of the same extension (same name) can be loaded: for the server-side and the client-side. They will be able to interact with each other through the <code>tunnel</code>/<code>remote</code> interfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">local MyExt = class("MyExt", vRP.Extension)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Loaded extensions are accessibles through the vRP instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">vRP.EXT.MyExt:test()</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can see how an extension is made by looking at the code of vRP <a href="../../vrp/modules">modules</a> or <a href="https://github.com/ImagicTheCat/vRP-basic-mission" class="bare">https://github.com/ImagicTheCat/vRP-basic-mission</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_user">User</h4>
<div class="paragraph">
<p>Extensions can extend User properties/methods with a User class (constructor is called).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
To not conflict with other extensions, make sure the added properties and methods have a very specific name or prefix.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">MyExt.User = class("User")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_event">Event</h4>
<div class="paragraph">
<p>Extensions can listen to global events by defining methods in the <code>event</code> table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">MyExt.event = {}

function MyExt.event:playerSpawn(user, first_spawn)
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Events marked with <code>(sync)</code> in the documentation may be called using <code>vRP:triggerEventSync</code> which will wait for the listeners to complete, meaning that listeners must return (mostly in a short time frame) in order to let the execution continue normally.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_proxy_and_tunnel_2">Proxy and Tunnel</h4>
<div class="paragraph">
<p>Extensions can listen to proxy/tunnel calls by defining methods in the <code>proxy</code> or <code>tunnel</code> table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">MyExt.proxy = {}
function MyExt.proxy:getInfo()
end

-- client-side
MyExt.tunnel = {}
function MyExt.tunnel:test()
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The proxy interface generated will be accessible from other resources like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">local my_ext = Proxy.getInterface("vRP.EXT.MyExt")
local info = my_ext.getInfo()</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Extensions don&#8217;t need and should not use proxy between them.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The tunnel is accessible (from the client-side or server-side extension) through the <code>remote</code> table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- server-side
function MyExt.event:playerSpawn(user, first_spawn)
  self.remote._test(user.source)
end

-- client-side
function MyExt.event:playerDeath()
  self.remote._test()
end</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_profiler">Profiler</h3>
<div class="paragraph">
<p>vRP embeds <a href="https://github.com/ImagicTheCat/ELProfiler">ELProfiler</a> to profile Lua code, vRP and resources based on it. When a resource loads <code>@vrp/lib/utils.lua</code> (which is the case for resources based on vRP), it will setup itself to be recorded by the profiler.</p>
</div>
<div class="paragraph">
<p>To use the profiler, the module must be enabled in <code>cfg/modules.lua</code>. This will keep track of created coroutines to profile them. The overhead is probably small, thus it can be enabled on a live server.</p>
</div>
<div class="paragraph">
<p>Two options are available (with permissions) in the main and admin menus to respectively profile the client-side or server-side.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Profiling has an overhead, but mostly because of the Lua debug hook. Being a statistical/sampling profiler, profiling a long period of time is fine (low memory usage).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_api">General API</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_utils">utils</h3>
<div class="paragraph">
<p><code>lib/utils.lua</code> defines some useful globals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- side detection
SERVER -- boolean
CLIENT -- boolean

-- load a lua resource file as module (for a specific side)
-- rsc: resource name
-- path: lua file path without extension
module(rsc, path)

class -- Luaoop class

-- create an async returner or a thread (Citizen.CreateThreadNow)
-- func: if passed, will create a thread, otherwise will return an async returner
async(func)

-- convert Lua string to hexadecimal
tohex(str)

-- basic deep clone function (doesn't handle circular references)
clone(t)

parseInt(v)

-- will remove chars not allowed/disabled by strchars
-- allow_policy: if true, will allow all strchars, if false, will allow everything except the strchars
sanitizeString(str, strchars, allow_policy)

splitString(str, sep)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_proxy_and_tunnel_3">Proxy and Tunnel</h3>
<div class="sect3">
<h4 id="_proxy">Proxy</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- add event handler to call interface functions
-- name: interface name
-- itable: table containing functions
Proxy.addInterface(name, itable)

-- get a proxy interface
-- name: interface name
-- identifier: (optional) unique string to identify this proxy interface access; if nil, will be the name of the resource
Proxy.getInterface(name, identifier)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tunnel">Tunnel</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- set the base delay between Triggers for a destination
-- dest: player source
-- delay: milliseconds (0 for instant trigger)
Tunnel.setDestDelay(dest, delay)

-- bind an interface (listen to net requests)
-- name: interface name
-- interface: table containing functions
Tunnel.bindInterface(name,interface)

-- get a tunnel interface to send requests
-- name: interface name
-- identifier: (optional) unique string to identify this tunnel interface access; if nil, will be the name of the resource
Tunnel.getInterface(name,identifier)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_interface">Interface</h4>
<div class="ulist">
<ul>
<li>
<p>interface defined function names should not start with an underscore (<code>_</code>)</p>
</li>
<li>
<p>the tunnel server-side call requires the player source as first parameter</p>
</li>
<li>
<p>the tunnel server-side called function can use the global <code>source</code> (correct until a TriggerEvent/yield/etc) as the remote player source</p>
</li>
<li>
<p>using an underscore to call a remote function interface ignores (no wait) the returned values</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- PROXY any side, TUNNEL client-side

-- call and wait for returned values
-- ...: arguments
-- return values
interface.func(...)

-- call without waiting
-- ...: arguments
interface._func(...)

-- TUNNEL server-side

-- call and wait for returned values
-- ...: arguments
-- return values
interface.func(player, ...) -- or _func to ignore returned values</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dbdriver">DBDriver</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- called when the driver is initialized (connection), should return true on success
-- db_cfg: cfg/base.lua .db config
DBDriver:onInit(db_cfg)

-- should prepare the query (@param notation)
DBDriver:onPrepare(name, query)

-- should execute the prepared query
-- params: map of parameters
-- mode:
--- "query": should return rows, affected
--- "execute": should return affected
--- "scalar": should return a scalar
DBDriver:onQuery(name, params, mode)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extension_2">Extension</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.remote -- tunnel interface to other network side

-- level: (optional) level, 0 by default
Extension:log(msg, level)

Extension:error(msg)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_2">User</h3>
<div class="paragraph">
<p>User inherits from all extensions sub-class User (if registered before the first user instantiation).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.source
self.name -- FiveM name (may be steam name)
self.id
self.cid -- character id
self.endpoint -- FiveM endpoint
self.data -- user data
self.cdata -- character data
self.loading_character -- flag
self.use_character_action -- action delay
self.spawns -- spawn count

-- return true if the user character is ready (loaded, not loading)
User:isReady()

User:save()

-- return characters id list
User:getCharacters()

-- return created character id or nil if failed
User:createCharacter()

-- use character
-- return true or false, err_code
-- err_code:
--- 1: delay error, too soon
--- 2: already loading
--- 3: invalid character
User:useCharacter(id)

-- delete character
-- return true or false on failure
User:deleteCharacter(id)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vrp">vRP</h3>
<div class="sect3">
<h4 id="_shared">Shared</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.EXT -- map of name =&gt; ext
self.modules -- cfg/modules

vRP.Extension

-- register an extension
-- extension: Extension class
vRP:registerExtension(extension)

-- trigger event (with async call for each listener)
vRP:triggerEvent(name, ...)

-- trigger event and wait for all listeners to complete
vRP:triggerEventSync(name, ...)

-- msg: log message
-- suffix: (optional) category, string
-- level: (optional) level, 0 by default
vRP:log(msg, suffix, level)

-- msg: error message
-- suffix: optional category, string
vRP:error(msg, suffix)</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>extensionLoad(extension)</code>
</td>
<td class="hdlist2">
<p>called when an extension is loaded, passing the extension instance (can be used to initialize with another extension when loaded before the latter)</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_server">Server</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg -- cfg/base config
self.lang -- loaded lang (https://github.com/ImagicTheCat/Luang)
self.users -- map of id =&gt; User
self.pending_users -- pending user source update (first spawn), map of ids key =&gt; user
self.users_by_source -- map of source =&gt; user
self.users_by_cid -- map of character id =&gt; user

-- db/SQL API
self.db_drivers
self.db_driver
self.db_initialized

vRP.DBDriver

-- return identification string for a specific source
vRP.getSourceIdKey(source)

vRP.getPlayerEndpoint(player)

vRP.getPlayerName(player)

-- register a DB driver
-- db_driver: DBDriver class
vRP:registerDBDriver(db_driver)

-- prepare a query
--- name: unique name for the query
--- query: SQL string with @params notation
vRP:prepare(name, query)

-- execute a query
--- name: unique name of the query
--- params: map of parameters
--- mode: default is "query"
---- "query": should return rows (list of map of parameter =&gt; value), affected
---- "execute": should return affected
---- "scalar": should return a scalar
vRP:query(name, params, mode)

-- shortcut for vRP.query with "execute"
vRP:execute(name, params)

-- shortcut for vRP.query with "scalar"
vRP:scalar(name, params)

-- user data
-- value: binary string
vRP:setUData(user_id,key,value)

vRP:getUData(user_id,key)

-- character data
-- value: binary string
vRP:setCData(character_id,key,value)

vRP:getCData(character_id,key)

-- server data
-- value: binary string
vRP:setSData(key,value,id)

vRP:getSData(key,id)

-- global data
-- value: binary string
vRP:setGData(key,value)

vRP:getGData(key)

-- reason: (optional)
vRP:kick(user, reason)

vRP:save()</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
(sync) <code>characterLoad(user)</code>
</td>
<td class="hdlist2">
<p>called right after the character loading</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(sync) <code>characterUnload(user)</code>
</td>
<td class="hdlist2">
<p>called before character unloading</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerJoin(user)</code>
</td>
<td class="hdlist2">
<p>called when a player joins (valid user)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerRejoin(user)</code>
</td>
<td class="hdlist2">
<p>called when a player re-joins (ex: after a crash)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerDelay(user, state)</code>
</td>
<td class="hdlist2">
<p>called when the player tunnel delay changes, <code>state</code> is true if delay is enabled</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerSpawn(user, first_spawn)</code>
</td>
<td class="hdlist2">
<p>called when the player spawns</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerDeath(user)</code>
</td>
<td class="hdlist2">
<p>called when the player dies</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(sync) <code>playerLeave(user)</code>
</td>
<td class="hdlist2">
<p>called before user removal</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>save</code>
</td>
<td class="hdlist2">
<p>called when vRP performs a save (can be used to sync the save of external extension data)</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_client">Client</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg -- cfg/client config</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerSpawn()</code>
</td>
<td class="hdlist2">
<p>called when the player spawns</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerDeath()</code>
</td>
<td class="hdlist2">
<p>called when the player dies</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modules">Modules</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_admin">Admin</h3>
<div class="paragraph">
<p>The admin module adds an administration (kick,ban&#8230;&#8203;) menu and functions.</p>
</div>
<div class="sect3">
<h4 id="_extension_3">Extension</h4>
<div class="sect4">
<h5 id="_client_2">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">Admin:toggleNoclip()
Admin:teleportToMarker()

-- TUNNEL

Admin.tunnel.toggleNoclip = Admin.toggleNoclip
Admin.tunnel.teleportToMarker = Admin.teleportToMarker</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu">Menu</h4>
<div class="sect4">
<h5 id="_admin_2">admin</h5>
<div class="paragraph">
<p>Administration menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_admin_users">admin.users</h5>
<div class="paragraph">
<p>Administration sub-menu: user list.</p>
</div>
</div>
<div class="sect4">
<h5 id="_admin_users_user">admin.users.user</h5>
<div class="paragraph">
<p>Administration sub-menu: user.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
id
</td>
<td class="hdlist2">
<p>user id (offline or online)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_aptitude">Aptitude</h3>
<div class="paragraph">
<p>This module adds aptitudes and experience (skill/education).</p>
</div>
<div class="sect3">
<h4 id="_extension_4">Extension</h4>
<div class="sect4">
<h5 id="_user_3">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.aptitudes

-- return user aptitudes table
User:getAptitudes()

-- vary experience of an aptitude
User:varyExp(group, aptitude, amount)

-- level up an aptitude
User:levelUp(group, aptitude)

-- level down an aptitude
User:levelDown(group, aptitude)

User:getExp(group, aptitude)

-- set aptitude experience
User:setExp(group, aptitude, amount)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_2">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.exp_step
self.groups

-- define aptitude group
Aptitude:defineGroup(group, title)

-- define aptitude
-- max_exp: -1 =&gt; infinite
Aptitude:defineAptitude(group, aptitude, title, init_exp, max_exp)

-- get aptitude definition
Aptitude:getAptitude(group, aptitude)

-- get aptitude group title
-- return string
Aptitude:getGroupTitle(group)

-- convert experience to level
-- return float
Aptitude:expToLevel(exp)

-- convert level to experience
-- return integer
Aptitude:levelToExp(lvl)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_permission">Permission</h4>
<div class="sect4">
<h5 id="_aptitude_2">aptitude</h5>
<div class="paragraph">
<p>Aptitude level comparison.</p>
</div>
<div class="paragraph">
<p><code>!aptitude.&lt;group&gt;.&lt;aptitude&gt;.&lt;op&gt;</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
group, aptitude
</td>
<td class="hdlist2">
<p>aptitude</p>
</td>
</tr>
<tr>
<td class="hdlist1">
op
</td>
<td class="hdlist2">
<p>&gt;x, &lt;x, x (equal) level</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>!aptitude.physical.strength.&gt;3</code>
</td>
<td class="hdlist2">
<p>strength level superior to 3</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_2">Menu</h4>
<div class="sect4">
<h5 id="_aptitudes">aptitudes</h5>
<div class="paragraph">
<p>Aptitudes display menu.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_transformer_processor">Transformer processor</h4>
<div class="paragraph">
<p>Produce experience in transformers.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>aptitudes</code> (products only)</dt>
<dd>
<p>map of <code>group.aptitude</code> &#8658; amount of experience</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>...
aptitudes = {
  ["physical.strength"] = 1
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_atm">ATM</h3>
<div class="paragraph">
<p>This module spawns ATMs to interact with the bank.</p>
</div>
<div class="sect3">
<h4 id="_extension_5">Extension</h4>
<div class="sect4">
<h5 id="_server_3">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_3">Menu</h4>
<div class="sect4">
<h5 id="_atm_2">ATM</h5>
<div class="paragraph">
<p>ATM menu.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_audio">Audio</h3>
<div class="paragraph">
<p>This module handles audio features.</p>
</div>
<div class="ulist">
<div class="title">VoIP</div>
<ul>
<li>
<p>a <code>voip_server</code> (nodejs) must be launched for each vRP server (by executing <code>main.js</code>)</p>
</li>
<li>
<p>nodejs <code>ws</code> and <code>wrtc</code> packages are required</p>
</li>
<li>
<p>the TCP websocket and UDP webrtc range of ports must be opened by firewalls</p>
</li>
<li>
<p>see <code>voip_server/config.js</code> and <code>cfg/audio.lua</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The clients will automatically connect/reconnect themselves to the VoIP server (can be started after, shutdown, restarted).
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_extension_6">Extension</h4>
<div class="sect4">
<h5 id="_server_4">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.channels -- map of id =&gt; {index, config} (available after the first player connection)

-- register VoIP channel
-- all channels should be registered before any player joins the server
--
-- id: channel name/id (string)
-- config:
--- effects: map of name =&gt; true/options
---- spatialization =&gt; { max_dist: ..., rolloff: ..., dist_model: ..., ref_dist: ...} (per peer effect)
---- biquad =&gt; { frequency: ..., Q: ..., type: ..., detune: ..., gain: ...} see WebAudioAPI BiquadFilter
----- freq = 1700, Q = 3, type = "bandpass" (idea for radio effect)
---- gain =&gt; { gain: ... }
Audio:registerVoiceChannel(id, config)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_3">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.voice_channels = {} -- map of channel =&gt; map of player =&gt; state (0-1)

-- play audio source (once)
--- url: valid audio HTML url (ex: .ogg/.wav/direct ogg-stream url)
--- volume: 0-1
--- x,y,z: position (omit for unspatialized)
--- max_dist  (omit for unspatialized)
--- player: (optional) player source id, if passed the spatialized source will be relative to the player (parented)
Audio:playAudioSource(url, volume, x, y, z, max_dist, player)

-- set named audio source (looping)
--- name: source name
--- url: valid audio HTML url (ex: .ogg/.wav/direct ogg-stream url)
--- volume: 0-1
--- x,y,z: position (omit for unspatialized)
--- max_dist  (omit for unspatialized)
--- player: (optional) player source id, if passed the spatialized source will be relative to the player (parented)
Audio:setAudioSource(name, url, volume, x, y, z, max_dist, player)

-- remove named audio source
Audio:removeAudioSource(name)

-- VoIP

-- create connection to another player for a specific channel
Audio:connectVoice(channel, player)

-- delete connection to another player for a specific channel
-- player: nil to disconnect from all players
Audio:disconnectVoice(channel, player)

-- enable/disable speaking for a specific channel
--- active: true/false
Audio:setVoiceState(channel, active)

Audio:isSpeaking()

-- TUNNEL

Audio.tunnel.playAudioSource = Audio.playAudioSource
Audio.tunnel.setAudioSource = Audio.setAudioSource
Audio.tunnel.removeAudioSource = Audio.removeAudioSource
Audio.tunnel.connectVoice = Audio.connectVoice
Audio.tunnel.disconnectVoice = Audio.disconnectVoice
Audio.tunnel.setVoiceState = Audio.setVoiceState</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>speakingChange(speaking)</code>
</td>
<td class="hdlist2">
<p>called when speaking state changes</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>voiceChannelPlayerSpeakingChange(channel, player, speaking)</code>
</td>
<td class="hdlist2">
<p>called when the speaking state of a remote player for a specific channel changes (VoIP)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>voiceChannelTransmittingChange(channel, transmitting)</code>
</td>
<td class="hdlist2">
<p>called when the transmitting state of the local player for a specific channel changes (VoIP)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_base">Base</h3>
<div class="paragraph">
<p>vRP base module.</p>
</div>
<div class="sect3">
<h4 id="_extension_7">Extension</h4>
<div class="sect4">
<h5 id="_server_5">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua"></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_4">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.id -- user id
self.cid -- character id
self.players -- map of player id, keeps track of connected players (server id)
self.ragdoll -- flag

-- trigger vRP respawn
Base:triggerRespawn()

-- heading: (optional) entity heading
Base:teleport(x,y,z,heading)

-- teleport vehicle when inside one (placed on ground)
-- heading: (optional) entity heading
Base:vehicleTeleport(x,y,z,heading)

-- return x,y,z
Base:getPosition()

-- return false if in exterior, true if inside a building
Base:isInside()

-- return ped speed (based on velocity)
Base:getSpeed()

-- return dx,dy,dz
Base:getCamDirection()

-- return map of player id =&gt; distance
Base:getNearestPlayers(radius)

-- return player id or nil
Base:getNearestPlayer(radius)

-- GTA 5 text notification
Base:notify(msg)

-- GTA 5 picture notification
Base:notifyPicture(icon, type, sender, title, text)

-- SCREEN

-- play a screen effect
-- name, see https://wiki.fivem.net/wiki/Screen_Effects
-- duration: in seconds, if -1, will play until stopScreenEffect is called
Base:playScreenEffect(name, duration)

-- stop a screen effect
-- name, see https://wiki.fivem.net/wiki/Screen_Effects
Base:stopScreenEffect(name)

-- ANIM

-- animations dict and names: http://docs.ragepluginhook.net/html/62951c37-a440-478c-b389-c471230ddfc5.htm

-- play animation (new version)
-- upper: true, only upper body, false, full animation
-- seq: list of animations as {dict,anim_name,loops} (loops is the number of loops, default 1) or a task def (properties: task, play_exit)
-- looping: if true, will infinitely loop the first element of the sequence until stopAnim is called
Base:playAnim(upper, seq, looping)

-- stop animation (new version)
-- upper: true, stop the upper animation, false, stop full animations
Base:stopAnim(upper)

-- RAGDOLL

-- set player ragdoll flag (true or false)
Base:setRagdoll(flag)

-- SOUND
-- some lists:
-- pastebin.com/A8Ny8AHZ
-- https://wiki.gtanet.work/index.php?title=FrontEndSoundlist

-- play sound at a specific position
Base:playSpatializedSound(dict,name,x,y,z,range)

-- play sound
Base:playSound(dict,name)

-- TUNNEL

Base.tunnel.triggerRespawn = Base.triggerRespawn
Base.tunnel.teleport = Base.teleport
Base.tunnel.vehicleTeleport = Base.vehicleTeleport
Base.tunnel.getPosition = Base.getPosition
Base.tunnel.isInside = Base.isInside
Base.tunnel.getSpeed = Base.getSpeed
Base.tunnel.getNearestPlayers = Base.getNearestPlayers
Base.tunnel.getNearestPlayer = Base.getNearestPlayer
Base.tunnel.notify = Base.notify
Base.tunnel.notifyPicture = Base.notifyPicture
Base.tunnel.playScreenEffect = Base.playScreenEffect
Base.tunnel.stopScreenEffect = Base.stopScreenEffect
Base.tunnel.playAnim = Base.playAnim
Base.tunnel.stopAnim = Base.stopAnim
Base.tunnel.setRagdoll = Base.setRagdoll
Base.tunnel.playSpatializedSound = Base.playSpatializedSound
Base.tunnel.playSound = Base.playSound</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerTeleport()</code>
</td>
<td class="hdlist2">
<p>called when the player is teleported</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_4">Menu</h4>
<div class="sect4">
<h5 id="_characters">characters</h5>
<div class="paragraph">
<p>Characters menu.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_permission_2">Permission</h4>
<div class="sect4">
<h5 id="_inside">inside</h5>
<div class="paragraph">
<p><code>!inside</code></p>
</div>
<div class="paragraph">
<p>Check if inside a building (interior).
Will do a tunnel call.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_business">Business</h3>
<div class="paragraph">
<p>This module adds a simple business system (dirty money, capital&#8230;&#8203;).</p>
</div>
<div class="sect3">
<h4 id="_extension_8">Extension</h4>
<div class="sect4">
<h5 id="_server_6">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg

-- return character business data or nil
Business:getBusiness(character_id)

-- close the business of a character
Business:closeBusiness(character_id)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item">Item</h4>
<div class="sect4">
<h5 id="_dirty_money">dirty_money</h5>
<div class="paragraph">
<p>Can be converted to money using business money laundering.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_5">Menu</h4>
<div class="sect4">
<h5 id="_commerce_chamber">commerce_chamber</h5>
<div class="paragraph">
<p>Commerce chamber menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_commerce_chamber_directory">commerce_chamber.directory</h5>
<div class="paragraph">
<p>Business directory.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
page
</td>
<td class="hdlist2">
<p>page index, start at 0</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloak">Cloak</h3>
<div class="paragraph">
<p>This module manages character cloaks (uniforms, etc).</p>
</div>
<div class="sect3">
<h4 id="_extension_9">Extension</h4>
<div class="sect4">
<h5 id="_user_4">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.pre_cloak

-- cloak: skin customization
User:setCloak(cloak)

User:removeCloak()

User:hasCloak()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_7">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_6">Menu</h4>
<div class="sect4">
<h5 id="_cloakroom">cloakroom</h5>
<div class="paragraph">
<p>Cloakroom menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
type
</td>
<td class="hdlist2">
<p>cloakroom type</p>
</td>
</tr>
<tr>
<td class="hdlist1">
cloaks
</td>
<td class="hdlist2">
<p>cloakroom type table</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_edible">Edible</h3>
<div class="paragraph">
<p>This module defines a generic edible item.</p>
</div>
<div class="sect3">
<h4 id="_extension_10">Extension</h4>
<div class="sect4">
<h5 id="_server_8">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.types
self.effects
self.edibles

-- id: identifier (string)
-- action_name: (string)
-- on_consume(user, edible)
Edible:defineType(id, action_name, on_consume)

-- id: identifier (string)
-- on_effect(user, value)
Edible:defineEffect(id, on_effect)

-- id: identifier (string)
-- type: edible type
-- effects: map of effect =&gt; value
-- name: (string)
-- description: (html)
-- weight
Edible:defineEdible(id, type, effects, name, description, weight)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_2">Item</h4>
<div class="sect4">
<h5 id="_edible_2">edible</h5>
<div class="paragraph">
<p><code>edible|&lt;id&gt;</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
id
</td>
<td class="hdlist2">
<p>edible id</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>edible|tacos</code>
</td>
<td class="hdlist2">
<p>a tacos</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_emotes">Emotes</h3>
<div class="paragraph">
<p>This module adds an emotes menu.</p>
</div>
<div class="sect3">
<h4 id="_extension_11">Extension</h4>
<div class="sect4">
<h5 id="_user_5">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.emotes_action -- emotes action delay</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_9">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg

-- add a new emote
-- see cfg/emotes.lua
Emotes:add(config)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_7">Menu</h4>
<div class="sect4">
<h5 id="_emotes_2">emotes</h5>
<div class="paragraph">
<p>Emotes menu.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_garage">Garage</h3>
<div class="paragraph">
<p>This module manages garages and character vehicles.</p>
</div>
<div class="paragraph">
<p>Each owned vehicle has a saved state which can be extended with new properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<div class="title">Vehicles in FiveM/GTA V are entities which can unload/load/despawn themselves on multiple clients, this module try to handle it this way.</div>
<ul>
<li>
<p>it tracks the owned vehicles with a decorator and will try to re-own the vehicles when near them</p>
</li>
<li>
<p>if multiple versions of the same owned vehicle exist at the same place, it will try to delete the others</p>
</li>
<li>
<p>vehicles states are saved and it will try to re-spawn the vehicles if near their last saved position</p>
</li>
<li>
<p>if a vehicle is stuck or completely lost somewhere, players can force its re-spawn at the garage by paying a fee</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_extension_12">Extension</h4>
<div class="sect4">
<h5 id="_user_6">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.vehicles
self.cdata.rent_vehicles
self.vehicle_states

-- get owned vehicles
-- return map of model
User:getVehicles()

-- get vehicle model state table (may be async)
User:getVehicleState(model)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_10">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.models -- map of all garage defined models

-- get vehicle trunk chest id by character id and model
Garage.getVehicleChestId(cid, model)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_5">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.vehicles -- map of vehicle model =&gt; veh id (owned vehicles)
self.hash_models -- map of hash =&gt; model

-- veh: vehicle game id
-- return owner character id and model or nil if not managed by vRP
Garage:getVehicleInfo(veh)

-- spawn vehicle (will despawn first)
-- will be placed on ground properly
-- one vehicle per model allowed at the same time
--
-- state: (optional) vehicle state (client)
-- position: (optional) {x,y,z}, if not passed the vehicle will be spawned on the player (and will be put inside the vehicle)
-- rotation: (optional) quaternion {x,y,z,w}, if passed with the position, will be applied to the vehicle entity
Garage:spawnVehicle(model, state, position, rotation)

-- return true if despawned
Garage:despawnVehicle(model)

Garage:despawnVehicles()

-- get all game vehicles
-- return list of veh
Garage:getAllVehicles()

-- return map of veh =&gt; distance
Garage:getNearestVehicles(radius)

-- return veh
Garage:getNearestVehicle(radius)

Garage:trySpawnOutVehicles()

-- try re-own vehicles
Garage:tryOwnVehicles()

-- cleanup invalid owned vehicles
Garage:cleanupVehicles()

Garage:fixNearestVehicle(radius)

Garage:replaceNearestVehicle(radius)

-- return model or nil
Garage:getNearestOwnedVehicle(radius)

-- return ok,x,y,z
Garage:getAnyOwnedVehiclePosition()

-- return x,y,z or nil
Garage:getOwnedVehiclePosition(model)

Garage:putInOwnedVehicle(model)

-- eject the ped from the vehicle
Garage:ejectVehicle()

Garage:isInVehicle()

-- return model or nil if not in owned vehicle
Garage:getInOwnedVehicleModel()

-- VEHICLE STATE

Garage:getVehicleCustomization(veh)

-- partial update per property
Garage:setVehicleCustomization(veh, custom)

Garage:getVehicleState(veh)

-- partial update per property
Garage:setVehicleState(veh, state)

-- VEHICLE COMMANDS

Garage:vc_openDoor(model, door_index)

Garage:vc_closeDoor(model, door_index)

Garage:vc_detachTrailer(model)

Garage:vc_detachTowTruck(model)

Garage:vc_detachCargobob(model)

Garage:vc_toggleEngine(model)

-- return true if locked, false if unlocked
Garage:vc_toggleLock(model)

-- TUNNEL

Garage.tunnel.spawnVehicle = Garage.spawnVehicle
Garage.tunnel.despawnVehicle = Garage.despawnVehicle
Garage.tunnel.despawnVehicles = Garage.despawnVehicles
Garage.tunnel.fixNearestVehicle = Garage.fixNearestVehicle
Garage.tunnel.replaceNearestVehicle = Garage.replaceNearestVehicle
Garage.tunnel.getNearestOwnedVehicle = Garage.getNearestOwnedVehicle
Garage.tunnel.getAnyOwnedVehiclePosition = Garage.getAnyOwnedVehiclePosition
Garage.tunnel.getOwnedVehiclePosition = Garage.getOwnedVehiclePosition
Garage.tunnel.putInOwnedVehicle = Garage.putInOwnedVehicle
Garage.tunnel.getInOwnedVehicleModel = Garage.getInOwnedVehicleModel
Garage.tunnel.trySpawnOutVehicles = Garage.trySpawnOutVehicles
Garage.tunnel.cleanupVehicles = Garage.cleanupVehicles
Garage.tunnel.tryOwnVehicles = Garage.tryOwnVehicles
Garage.tunnel.ejectVehicle = Garage.ejectVehicle
Garage.tunnel.isInVehicle = Garage.isInVehicle
Garage.tunnel.vc_openDoor = Garage.vc_openDoor
Garage.tunnel.vc_closeDoor = Garage.vc_closeDoor
Garage.tunnel.vc_detachTrailer = Garage.vc_detachTrailer
Garage.tunnel.vc_detachTowTruck = Garage.vc_detachTowTruck
Garage.tunnel.vc_detachCargobob = Garage.vc_detachCargobob
Garage.tunnel.vc_toggleEngine = Garage.vc_toggleEngine
Garage.tunnel.vc_toggleLock = Garage.vc_toggleLock</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>garageVehicleSpawn(model)</code>
</td>
<td class="hdlist2">
<p>called when a vehicle is spawned</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>garageVehicleDespawn(model)</code>
</td>
<td class="hdlist2">
<p>called when a vehicle is despawned</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_3">Item</h4>
<div class="sect4">
<h5 id="_repairkit">repairkit</h5>
<div class="paragraph">
<p>Used to repair vehicles, but can be used for other stuff.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_8">Menu</h4>
<div class="sect4">
<h5 id="_vehicle">vehicle</h5>
<div class="paragraph">
<p>Owned vehicle menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
model
</td>
<td class="hdlist2">
<p>vehicle model</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_garage_2">garage</h5>
<div class="paragraph">
<p>Garage menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
type
</td>
<td class="hdlist2">
<p>garage type</p>
</td>
</tr>
<tr>
<td class="hdlist1">
vehicles
</td>
<td class="hdlist2">
<p>garage type table</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_garage_owned">garage.owned</h5>
<div class="paragraph">
<p>Garage sub-menu.
Same data as <code>garage</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_garage_buy">garage.buy</h5>
<div class="paragraph">
<p>Garage sub-menu.
Same data as <code>garage</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_garage_sell">garage.sell</h5>
<div class="paragraph">
<p>Garage sub-menu.
Same data as <code>garage</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_garage_rent">garage.rent</h5>
<div class="paragraph">
<p>Garage sub-menu.
Same data as <code>garage</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_permission_3">Permission</h4>
<div class="sect4">
<h5 id="_in_vehicle">in_vehicle</h5>
<div class="paragraph">
<p><code>!in_vehicle</code></p>
</div>
<div class="paragraph">
<p>Will do a tunnel call.</p>
</div>
</div>
<div class="sect4">
<h5 id="_in_owned_vehicle">in_owned_vehicle</h5>
<div class="paragraph">
<p><code>!in_owned_vehicle[.&lt;model&gt;]</code></p>
</div>
<div class="paragraph">
<p>Will do a tunnel call.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
model
</td>
<td class="hdlist2">
<p>(optional) vehicle model</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Examples</div>
<table>
<tr>
<td class="hdlist1">
<code>!in_owned_vehicle</code>
</td>
<td class="hdlist2">
<p>check if inside an owned vehicle</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>!in_owned_vehicle.taxi</code>
</td>
<td class="hdlist2">
<p>check if inside owned taxi model</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vehicle_state">Vehicle state</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
customization
</td>
<td class="hdlist2">
<p>customization properties</p>
</td>
</tr>
<tr>
<td class="hdlist1">
condition
</td>
<td class="hdlist2">
<p>damages properties</p>
</td>
</tr>
<tr>
<td class="hdlist1">
position, rotation
</td>
<td class="hdlist2">
<p>position/rotation for persistence</p>
</td>
</tr>
<tr>
<td class="hdlist1">
locked
</td>
<td class="hdlist2">
<p>doors state</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_group">Group</h3>
<div class="paragraph">
<p>This module adds groups and permissions.</p>
</div>
<div class="sect3">
<h4 id="_extension_13">Extension</h4>
<div class="sect4">
<h5 id="_user_7">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.groups

-- return map of groups
User:getGroups()

User:hasGroup(name)

User:addGroup(name)

User:removeGroup(name)

-- get user group by type
-- return group name or nil
User:getGroupByType(gtype)

-- check if the user has a specific permission
User:hasPermission(perm)

-- check if the user has a specific list of permissions (all of them)
User:hasPermissions(perms)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_11">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg

-- return users list
Group:getUsersByGroup(name)

-- return users list
Group:getUsersByPermission(perm)

-- return title or nil
Group:getGroupTitle(group_name)

-- register a special permission function
-- name: name of the permission -&gt; "!name.[...]"
-- callback(user, params)
--- params: params (strings) of the permissions, ex "!name.param1.param2" -&gt; ["name", "param1", "param2"]
--- should return true or false/nil
Group:registerPermissionFunction(name, callback)</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerJoinGroup(user, name, gtype)</code>
</td>
<td class="hdlist2">
<p>called when a player joins a group</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerLeaveGroup(user, name, gtype)</code>
</td>
<td class="hdlist2">
<p>called when a player leaves a group</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_9">Menu</h4>
<div class="sect4">
<h5 id="_group_selector">group_selector</h5>
<div class="paragraph">
<p>Group selector menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
name
</td>
<td class="hdlist2">
<p>selector name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
groups
</td>
<td class="hdlist2">
<p>selector table</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_permission_4">Permission</h4>
<div class="sect4">
<h5 id="_not">not</h5>
<div class="paragraph">
<p>Negate another permission function.</p>
</div>
<div class="paragraph">
<p><code>!not.&lt;&#8230;&#8203;&gt;</code></p>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>!not.group.admin</code>
</td>
<td class="hdlist2">
<p>check if not an admin</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_group_2">group</h5>
<div class="paragraph">
<p>Group check.</p>
</div>
<div class="paragraph">
<p><code>!group.&lt;name&gt;</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
name
</td>
<td class="hdlist2">
<p>group name</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>!group.admin</code>
</td>
<td class="hdlist2">
<p>check if an admin</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gui">GUI</h3>
<div class="paragraph">
<p>This module adds GUI features.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If GUI customization is needed, it&#8217;s possible to use <code>GUI:setDiv</code> to add additional CSS (the override order should depends on <code>GUI:setDiv</code> call order).</p>
</div>
<div class="listingblock">
<div class="title">It&#8217;s even possible to load a custom client-side <code>design.css</code> file like this:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">-- client-side
function MyExt.event:NUIready()
  vRP.EXT.GUI:addDiv("my_ext_css", LoadResourceFile("my_ext", "design.css"), "")
end</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_extension_14">Extension</h4>
<div class="sect4">
<h5 id="_menu_10">Menu</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.user
self.name
self.data
self.title
self.options
self.css
self.closed

-- dispatcher events:
--- close(menu)
--- remove(menu)
--- select(menu, id)
Menu:listen(name, callback)

-- add option
-- title: option title (html)
-- action(menu, value, mod, index): (optional) select callback
--- value: option value
--- mod: action modulation
---- -1: left
---- 0: valid
---- 1: right
-- description: (optional) option description (html)
--- callback(menu, value): should return a string or nil
-- value: (optional) option value, can be anything, option index by default
-- index: (optional) by default the option is added at the end, but an index can be used to insert the option
Menu:addOption(title, action, description, value, index)

-- update menu option
-- title: (optional) as Menu:addOption
-- description: (optional) as Menu:addOption
-- will trigger client update if current menu
Menu:updateOption(id, title, description)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_8">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.menu_stack -- stack of menus
self.request_ids
self.requests

-- return current menu or nil
User:getMenu()

-- open menu (build and open menu)
-- data: (optional) menu build data
-- return menu
User:openMenu(name, data)

-- close menu
-- menu: (optional) menu to close, if nil, will close the current menu
User:closeMenu(menu)

-- close and rebuild current menu (no remove)
-- menu is rebuilt, listeners are kept
User:actualizeMenu()

-- close all menus
User:closeMenus()

-- prompt textual (and multiline) information from player
-- return entered text
User:prompt(title, default_text)

-- REQUEST

-- ask something to a player with a limited amount of time to answer (yes|no request)
-- time: request duration in seconds
-- return true (yes) or false (no)
User:request(text, time)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_12">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.menu_builders -- map of name =&gt; callbacks list

-- register a menu builder function
-- name: menu type name
-- builder(menu): callback to modify the menu
GUI:registerMenuBuilder(name, builder)

-- TUNNEL

-- open the general player menu
GUI.tunnel:openMainMenu()

-- can be used to implement a custom menu

GUI.tunnel:closeMenu()
GUI.tunnel:triggerMenuOption(id, mod)
GUI.tunnel:triggerMenuSelect(id)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_6">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.paused
self.menu_data

-- CONTROLS/GUI

GUI:isPaused()

-- get native GUI coordinates based on UI description
-- x_align, y_align: integers, see https://runtime.fivem.net/doc/natives/#_0xB8A850F20A067EB6
-- x, y: floats, UI defined coordinates
GUI:getNativeCoords(x_align, y_align, x, y)

-- get minimap rect in pixels
-- return x, y, w, h
GUI:getMinimapRect()

-- hide/show GUI
GUI:setVisible(flag)

-- MENU

GUI:isMenuOpen()

-- ANNOUNCE

-- add an announce to the queue
-- background: image url (800x150)
-- content: announce html content
GUI:announce(background,content)

-- PROGRESS BAR

-- create/update a progress bar
-- anchor:
--- "minimap"
--- "center"
--- "botright"
-- r,g,b: RGB 256 color
-- value: 0-1
GUI:setProgressBar(name,anchor,text,r,g,b,value)

-- set progress bar value 0-1
GUI:setProgressBarValue(name,value)

-- set progress bar text
GUI:setProgressBarText(name,text)

-- remove a progress bar
GUI:removeProgressBar(name)

-- DIV

-- set a div
-- css: plain global css, the div class is "div_name"
-- content: html content of the div
GUI:setDiv(name,css,content)

-- set the div css
GUI:setDivCss(name,css)

-- set the div content
GUI:setDivContent(name,content)

-- execute js for the div
-- js: code, "this" is the div
GUI:divExecuteJS(name,js)

-- remove the div
GUI:removeDiv(name)

-- TUNNEL

GUI.tunnel.announce = GUI.announce
GUI.tunnel.setProgressBar = GUI.setProgressBar
GUI.tunnel.setProgressBarValue = GUI.setProgressBarValue
GUI.tunnel.setProgressBarText = GUI.setProgressBarText
GUI.tunnel.removeProgressBar = GUI.removeProgressBar
GUI.tunnel.setDiv = GUI.setDiv
GUI.tunnel.setDivCss = GUI.setDivCss
GUI.tunnel.setDivContent = GUI.setDivContent
GUI.tunnel.divExecuteJS = GUI.divExecuteJS
GUI.tunnel.removeDiv = GUI.removeDiv</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>NUIready()</code>
</td>
<td class="hdlist2">
<p>called when the vRP NUI is ready</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>pauseChange(paused)</code>
</td>
<td class="hdlist2">
<p>called when the game pause state changes</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>menuOpen(menudata)</code>
</td>
<td class="hdlist2">
<p>called when the menu is opened (can be used to implement a custom menu)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>menuClose()</code>
</td>
<td class="hdlist2">
<p>called when the menu is closed (can be used to implement a custom menu)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>menuSetSelectEvent(select_event)</code>
</td>
<td class="hdlist2">
<p>called when the select event flag is set (if true, the menu must trigger the server-side option select event) (can be used to implement a custom menu)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>menuOptionUpdate(index, title, description)</code>
</td>
<td class="hdlist2">
<p>called when a menu option is updated (can be used to implement a custom menu)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_11">Menu</h4>
<div class="sect4">
<h5 id="_main">main</h5>
<div class="paragraph">
<p>Main menu.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hiddentransformer">HiddenTransformer</h3>
<div class="paragraph">
<p>This module adds hidden/randomly placed transformers and an informer to find them.</p>
</div>
<div class="sect3">
<h4 id="_extension_15">Extension</h4>
<div class="sect4">
<h5 id="_server_13">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_12">Menu</h4>
<div class="sect4">
<h5 id="_hidden_transformer_informer">hidden_transformer_informer</h5>
<div class="paragraph">
<p>Informer menu.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_home">Home</h3>
<div class="paragraph">
<p>This module adds a home system.</p>
</div>
<div class="sect3">
<h4 id="_extension_16">Extension</h4>
<div class="sect4">
<h5 id="_component">Component</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.slot
self.id
self.index
self.cfg
self.x
self.y
self.z

-- called when the component is loaded for a specific slot
Component:load()

-- called when the component is unloaded from a specific slot
Component:unload()

-- called when a player enters the slot
Component:enter(user)

-- called when a player leaves the slot
Component:leave(user)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_slot">Slot</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.type
self.id
self.owner_id -- character id
self.home
self.number
self.users -- map of users
self.components -- map of index =&gt; component

Slot:isEmpty()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_9">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.home_slot
self.address

-- access a home by address
-- return true on success
User:accessHome(home, number)

User:leaveHome()

-- check if inside a home
User:inHome()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_14">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.components
self.slots -- map of type =&gt; map of slot id =&gt; slot instance

-- address access (online and offline characters)
-- return address or nil
Home:getAddress(cid)

-- return character id or nil
Home:getByAddress(home,number)

-- find a free address number to buy
-- return number or nil if no numbers availables
Home:findFreeNumber(home,max)

-- register home component
-- id: unique component identifier (string)
-- component: Home.Component derived class
Home:registerComponent(component)

-- SLOTS

-- get slot instance
-- return slot or nil
Home:getSlot(stype, sid)

-- get slot instance by address
-- return slot or nil
Home:getSlotByAddress(home, number)

-- return sid or nil
Home:findFreeSlot(stype)</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>characterAddressUpdate(user)</code>
</td>
<td class="hdlist2">
<p>called when the address is updated (load, buy, sell&#8230;&#8203;)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_13">Menu</h4>
<div class="sect4">
<h5 id="_home_2">home</h5>
<div class="paragraph">
<p>Home menu (outside).</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
name
</td>
<td class="hdlist2">
<p>home name</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_homecomponententry">home:component:entry</h5>
<div class="paragraph">
<p>Home entry menu (inside).</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
slot
</td>
<td class="hdlist2">
<p>component slot</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_home_component">Home component</h4>
<div class="sect4">
<h5 id="_entry">entry</h5>
<div class="paragraph">
<p>Home entry component.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_permission_5">Permission</h4>
<div class="sect4">
<h5 id="_home_3">home</h5>
<div class="paragraph">
<p>Home/address check.</p>
</div>
<div class="paragraph">
<p><code>!home[.&lt;name&gt;[.&lt;number&gt;]]</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
name
</td>
<td class="hdlist2">
<p>(optional) home name, all <code>.</code> characters should be removed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
number
</td>
<td class="hdlist2">
<p>(optional) home number</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>!home</code>
</td>
<td class="hdlist2">
<p>has a home</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>!home.HLM Vinewood</code>
</td>
<td class="hdlist2">
<p>lives at <code>HLM Vinewood</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>!home.HLM Vinewood.5</code>
</td>
<td class="hdlist2">
<p>lives at <code>5, HLM Vinewood</code></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_home_components">home_components</h3>
<div class="paragraph">
<p>This module adds some home components.</p>
</div>
<div class="sect3">
<h4 id="_extension_17">Extension</h4>
<div class="sect4">
<h5 id="_server_15">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_14">Menu</h4>
<div class="sect4">
<h5 id="_homecomponentwardrobe">home:component:wardrobe</h5>
<div class="paragraph">
<p>Wardrobe menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
sets
</td>
<td class="hdlist2">
<p>map of name &#8658; customization</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_homecomponentgametable">home:component:gametable</h5>
<div class="paragraph">
<p>Gametable menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_homecomponentradio">home:component:radio</h5>
<div class="paragraph">
<p>Radio menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
component
</td>
<td class="hdlist2">
<p>radio component</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_home_component_2">Home component</h4>
<div class="sect4">
<h5 id="_chest">chest</h5>
<div class="paragraph">
<p>A home chest to store items. The chest is bound to the character, not to the home or the component.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
weight
</td>
<td class="hdlist2">
<p>(optional) chest max weight, 200 by default</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_wardrobe">wardrobe</h5>
<div class="paragraph">
<p>Wardrobe to save/restore clothes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_gametable">gametable</h5>
<div class="paragraph">
<p>Gametable to play simple games with other people (bet&#8230;&#8203;).</p>
</div>
</div>
<div class="sect4">
<h5 id="_transformer">transformer</h5>
<div class="paragraph">
<p>Transformer component.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
cfg
</td>
<td class="hdlist2">
<p>transformer config</p>
</td>
</tr>
<tr>
<td class="hdlist1">
map_entity
</td>
<td class="hdlist2">
<p>(optional) map entity at the component position</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_radio">radio</h5>
<div class="paragraph">
<p>Component to play music in the home.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
stations
</td>
<td class="hdlist2">
<p>map of name &#8658; audio source URL</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identity">Identity</h3>
<div class="paragraph">
<p>This module adds an identity system.</p>
</div>
<div class="sect3">
<h4 id="_extension_18">Extension</h4>
<div class="sect4">
<h5 id="_user_10">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.identity</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_16">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg

-- (ex: DDDLLL, D =&gt; digit, L =&gt; letter)
Identity.generateStringNumber(format)

-- identity access (online and offline characters)
-- return identity or nil
Identity:getIdentity(cid)

-- return character_id or nil
Identity:getByRegistration(registration)

-- return character_id or nil
Identity:getByPhone(phone)

-- return a unique registration number
Identity:generateRegistrationNumber()

-- return a unique phone number
Identity:generatePhoneNumber()</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>characterIdentityUpdate(user)</code>
</td>
<td class="hdlist2">
<p>called when the identity is updated (load, change&#8230;&#8203;)</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_client_7">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.registration</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_15">Menu</h4>
<div class="sect4">
<h5 id="_identity_2">identity</h5>
<div class="paragraph">
<p>Identity menu, offline and online characters.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
cid
</td>
<td class="hdlist2">
<p>character id of the identity</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_cityhall">cityhall</h5>

</div>
</div>
</div>
<div class="sect2">
<h3 id="_inventory">Inventory</h3>
<div class="paragraph">
<p>This module adds an inventory/item system.</p>
</div>
<div class="sect3">
<h4 id="_extension_19">Extension</h4>
<div class="sect4">
<h5 id="_user_11">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.inventory

-- return map of fullid =&gt; amount
User:getInventory()

-- try to give an item
-- dry: if passed/true, will not affect
-- return true on success or false
User:tryGiveItem(fullid,amount,dry,no_notify)

-- try to take an item from inventory
-- dry: if passed/true, will not affect
-- return true on success or false
User:tryTakeItem(fullid,amount,dry,no_notify)

-- get item amount in the inventory
User:getItemAmount(fullid)

-- return inventory total weight
User:getInventoryWeight()

-- return maximum weight of inventory
User:getInventoryMaxWeight()

User:clearInventory()

-- open a chest by identifier (GData)
-- cb_close(id): called when the chest is closed (optional)
-- cb_in(chest_id, fullid, amount): called when an item is added (optional)
-- cb_out(chest_id, fullid, amount): called when an item is taken (optional)
-- return chest menu or nil
User:openChest(id, max_weight, cb_close, cb_in, cb_out)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_17">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.items -- item definitions
self.computed_items -- computed item definitions
self.chests -- loaded chests

-- define an inventory item (parametric or plain text data)
-- id: unique item identifier (string, no "." or "|")
-- name: display name, value or genfunction(args)
-- description: value or genfunction(args) (html)
-- menu_builder: (optional) genfunction(args, menu)
-- weight: (optional) value or genfunction(args)
--
-- genfunction are functions returning a correct value as: function(args, ...)
-- where args is a list of {base_idname,args...}
Inventory:defineItem(id,name,description,menu_builder,weight)

-- compute item definition (cached)
-- return computed item or nil
-- computed item {}
--- name
--- description
--- weight
--- menu_builder: can be nil
--- args: parametric args
Inventory:computeItem(fullid)

-- compute weight of a list of items (in inventory/chest format)
Inventory:computeItemsWeight(items)

-- load global chest
-- id: identifier (string)
-- return chest (as inventory, map of fullid =&gt; amount)
Inventory:loadChest(id)

-- unload global chest
-- id: identifier (string)
Inventory:unloadChest(id)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_16">Menu</h4>
<div class="sect4">
<h5 id="_inventory_2">inventory</h5>
<div class="paragraph">
<p>Player inventory menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_inventory_item">inventory.item</h5>
<div class="paragraph">
<p>Player inventory item sub-menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
fullid
</td>
<td class="hdlist2">
<p>item fullid</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_chest_2">chest</h5>
<div class="paragraph">
<p>Chest menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
id
</td>
<td class="hdlist2">
<p>chest id</p>
</td>
</tr>
<tr>
<td class="hdlist1">
chest
</td>
<td class="hdlist2">
<p>loaded chest</p>
</td>
</tr>
<tr>
<td class="hdlist1">
max_weight
</td>
<td class="hdlist2">
<p>chest max weight</p>
</td>
</tr>
<tr>
<td class="hdlist1">
cb_close
</td>
<td class="hdlist2">
<p>cb_close</p>
</td>
</tr>
<tr>
<td class="hdlist1">
cb_in
</td>
<td class="hdlist2">
<p>cb_in</p>
</td>
</tr>
<tr>
<td class="hdlist1">
cb_out
</td>
<td class="hdlist2">
<p>cb_out</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_chest_put">chest.put</h5>
<div class="paragraph">
<p>Chest put sub-menu. Same data as <code>chest</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_chest_take">chest.take</h5>
<div class="paragraph">
<p>Chest take sub-menu. Same data as <code>chest</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_permission_6">Permission</h4>
<div class="sect4">
<h5 id="_item_4">item</h5>
<div class="paragraph">
<p>Item amount comparison.</p>
</div>
<div class="paragraph">
<p><code>!item.&lt;fullid&gt;.&lt;op&gt;</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
fullid
</td>
<td class="hdlist2">
<p>item fullid</p>
</td>
</tr>
<tr>
<td class="hdlist1">
op
</td>
<td class="hdlist2">
<p>&gt;x, &lt;x, x (equal) amount</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Examples</div>
<table>
<tr>
<td class="hdlist1">
<code>!item.edible|tacos.&gt;0</code>
</td>
<td class="hdlist2">
<p>one or more tacos</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>!item.dirty_money.0</code>
</td>
<td class="hdlist2">
<p>no dirty money</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_transformer_processor_2">Transformer processor</h4>
<div class="paragraph">
<p>Consume and produce items in transformers.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>items</code></dt>
<dd>
<p>map of item fullid &#8658; amount</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>...
items = {
  ["edible|peach"] = 1
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_login">Login</h3>
<div class="paragraph">
<p>This is the base login module with whitelist and ban features.</p>
</div>
<div class="sect3">
<h4 id="_extension_20">Extension</h4>
<div class="sect4">
<h5 id="_server_18">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg

-- return (end_timestamp, reason) if banned or nil
Login:checkBanned(user_id)

-- end_timestamp: POSIX timestamp (0: not banned, 2^32-1: banned "forever")
-- reason: (optional)
Login:setBanned(user_id, end_timestamp, reason)

Login:isWhitelisted(user_id)

Login:setWhitelisted(user_id, whitelisted)

-- duration: in seconds (-1: ban "forever")
-- reason: (optional)
Login:ban(user, duration, reason)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_map">Map</h3>
<div class="paragraph">
<p>This module adds map features.</p>
</div>
<div class="sect3">
<h4 id="_extension_21">Extension</h4>
<div class="sect4">
<h5 id="_map_entity">Map.Entity</h5>
<div class="paragraph">
<p>Client-side map entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.id
self.cfg

-- called when the entity is loaded
Entity:load()

-- called when the entity is unloaded
Entity:unload()

-- called to check if the entity is active
-- px, py, pz: player position
-- should return true if active
Entity:active(px, py, pz)

-- called at each render frame if the entity is active
-- time: seconds since last frame
Entity:frame(time)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Entity.command</code> table can be created to define entity commands, the same way as for the <code>Extension.proxy</code> table.</p>
</div>
</div>
<div class="sect4">
<h5 id="_user_12">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.map_areas

-- create/update a player area
-- cb_enter(user, name): (optional) called when entering the area
-- cb_leave(user, name): (optional) called when leaving the area
User:setArea(name,x,y,z,radius,height,cb_enter,cb_leave)

User:removeArea(name)

User:inArea(name)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_19">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_8">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.entities -- map of id (number or name) =&gt; entity
self.def_entities -- defined entities
self.frame_entities -- active entities for the next frames
self.areas

-- ent: Map.Entity class
Map:registerEntity(ent)

-- add entity
-- ent: registered entity name
-- cfg: entity config
-- return id (number) or nil on failure
Map:addEntity(ent, cfg)

-- id: number or string
Map:removeEntity(id)

-- id: number (update added entity) or string (create/update named entity)
-- ent: registered entity name
-- cfg: entity config
Map:setEntity(id, ent, cfg)

-- entity command
-- id: number or string
-- command: command name
-- ...: arguments
Map:commandEntity(id, command, ...)

-- GPS

-- set the GPS destination marker coordinates
Map:setGPS(x,y)

-- DOOR

-- set the closest door state
-- doordef: .model or .modelhash
-- locked: boolean
-- doorswing: -1 to 1
Map:setStateOfClosestDoor(doordef, locked, doorswing)

-- TUNNEL

Map.tunnel.addEntity = Map.addEntity
Map.tunnel.setEntity = Map.setEntity
Map.tunnel.removeEntity = Map.removeEntity
Map.tunnel.commandEntity = Map.commandEntity
Map.tunnel.setGPS = Map.setGPS
Map.tunnel.setStateOfClosestDoor = Map.setStateOfClosestDoor</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_map_entity_2">Map entity</h4>
<div class="sect4">
<h5 id="_map_posentity">Map.PosEntity</h5>
<div class="paragraph">
<p>Specialized entity with a position and default active behavior by distance.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
pos
</td>
<td class="hdlist2">
<p><code>{x,y,z}</code> (must be floats)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
active_distance
</td>
<td class="hdlist2">
<p>(optional) maximum distance for the entity to be active, default is 250</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_poi">PoI</h5>
<div class="paragraph">
<p><strong>Point of Interest</strong> generic map entity (blip/marker).
Inherits from <code>Map.PosEntity</code>.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
blip_id, blip_color
</td>
<td class="hdlist2">
<p>(optional) blip id/color (ex: <a href="https://wiki.gtanet.work/index.php?title=Blips" class="bare">https://wiki.gtanet.work/index.php?title=Blips</a>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
blip_scale
</td>
<td class="hdlist2">
<p>(optional) float</p>
</td>
</tr>
<tr>
<td class="hdlist1">
blip_flashes
</td>
<td class="hdlist2">
<p>(optional) mode number <code>1</code> or <code>2</code> (flashes or flashes alternate)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
title
</td>
<td class="hdlist2">
<p>(optional) title (used for the blip)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
marker_id
</td>
<td class="hdlist2">
<p>(optional) marker id (ex: <a href="https://wiki.gtanet.work/index.php?title=Marker" class="bare">https://wiki.gtanet.work/index.php?title=Marker</a>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
scale
</td>
<td class="hdlist2">
<p>(optional) <code>{sx,sy,sz}</code> marker scale</p>
</td>
</tr>
<tr>
<td class="hdlist1">
color
</td>
<td class="hdlist2">
<p>(optional) <code>{r,g,b,a}</code> marker color</p>
</td>
</tr>
<tr>
<td class="hdlist1">
height
</td>
<td class="hdlist2">
<p>(optional) marker height</p>
</td>
</tr>
<tr>
<td class="hdlist1">
rotate_speed
</td>
<td class="hdlist2">
<p>(optional) number of z-axis rotations per second</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">commands</div>
<table>
<tr>
<td class="hdlist1">
<code>setBlipRoute()</code>
</td>
<td class="hdlist2">
<p>set player blip route to <code>PoI</code> blip</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_playermark">PlayerMark</h5>
<div class="paragraph">
<p>Mark on player ped.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
player
</td>
<td class="hdlist2">
<p>player server id</p>
</td>
</tr>
<tr>
<td class="hdlist1">
blip_id, blip_color
</td>
<td class="hdlist2">
<p>(optional) blip id/color (ex: <a href="https://wiki.gtanet.work/index.php?title=Blips" class="bare">https://wiki.gtanet.work/index.php?title=Blips</a>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
blip_scale
</td>
<td class="hdlist2">
<p>(optional) float</p>
</td>
</tr>
<tr>
<td class="hdlist1">
blip_flashes
</td>
<td class="hdlist2">
<p>(optional) mode number <code>1</code> or <code>2</code> (flashes or flashes alternate)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
title
</td>
<td class="hdlist2">
<p>(optional) title (used for the blip)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mission">Mission</h3>
<div class="paragraph">
<p>This module adds a simple mission system.</p>
</div>
<div class="sect3">
<h4 id="_extension_22">Extension</h4>
<div class="sect4">
<h5 id="_user_13">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.mission
self.mission_step

-- start a mission for a player
--- mission:
---- name: mission name
---- steps: ordered list of
----- text: (html)
----- position: {x,y,z}
----- radius: (optional) area radius (affect default PoI)
----- height: (optional) area height (affect default PoI)
----- onenter: see Map.User:setArea
----- onleave: (optional) see Map.User:setArea
----- map_entity: (optional) a simple PoI by default
User:startMission(mission)

-- end the current player mission step
User:nextMissionStep()

-- stop the player mission
User:stopMission()

-- check if the player has a mission
User:hasMission()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_20">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerMissionStart(user)</code>
</td>
<td class="hdlist2">
<p>called when the player start a mission (the mission data is attached to the player at the beginning of the call)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerMissionStep(user)</code>
</td>
<td class="hdlist2">
<p>called when the player start a new mission step</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerMissionStop(user)</code>
</td>
<td class="hdlist2">
<p>called when the player stop the mission (the mission data is still attached to the player at the beginning of the call)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_money">Money</h3>
<div class="paragraph">
<p>This module adds money (wallet and bank).</p>
</div>
<div class="sect3">
<h4 id="_extension_23">Extension</h4>
<div class="sect4">
<h5 id="_user_14">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.wallet
self.cdata.bank


-- get wallet amount
User:getWallet()

-- get bank amount
User:getBank()

-- set wallet amount
User:setWallet(amount)

-- set bank amount
User:setBank(amount)

-- give money to bank
User:giveBank(amount)

-- give money to wallet
User:giveWallet(amount)

-- try a payment (with wallet)
-- dry: if passed/true, will not affect
-- return true if debited or false
User:tryPayment(amount, dry)

-- try a withdraw (from bank)
-- dry: if passed/true, will not affect
-- return true if withdrawn or false
User:tryWithdraw(amount, dry)

-- try a deposit
-- dry: if passed/true, will not affect
-- return true if deposited or false
User:tryDeposit(amount, dry)

-- try full payment (wallet + bank to complete payment)
-- dry: if passed/true, will not affect
-- return true if debited or false
User:tryFullPayment(amount, dry)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_21">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerMoneyUpdate(user)</code>
</td>
<td class="hdlist2">
<p>called when the player money is updated (load, change&#8230;&#8203;)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_5">Item</h4>
<div class="sect4">
<h5 id="_money_2">money</h5>
<div class="paragraph">
<p>Money packed as item.</p>
</div>
</div>
<div class="sect4">
<h5 id="_money_binder">money_binder</h5>
<div class="paragraph">
<p>Used to pack an amount of wallet money into money item.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_transformer_processor_3">Transformer processor</h4>
<div class="paragraph">
<p>Consume and produce money in transformers.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>money</code></dt>
<dd>
<p>amount</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>...
money = 200</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pedblacklist">PedBlacklist</h3>
<div class="paragraph">
<p>This module adds a ped blacklist (remove peds from the game).</p>
</div>
<div class="sect3">
<h4 id="_extension_24">Extension</h4>
<div class="sect4">
<h5 id="_server_22">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_9">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.ped_models -- map of model hash
self.interval</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_phone">Phone</h3>
<div class="paragraph">
<p>This module adds a phone.</p>
</div>
<div class="sect3">
<h4 id="_extension_25">Extension</h4>
<div class="sect4">
<h5 id="_user_15">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.phone_sms
self.cdata.phone_directory
self.phone_call -- source of correspondent if in phone call

-- send an sms to a phone number
-- return true on success
User:sendSMS(phone, msg)

-- add sms to phone
User:addSMS(phone, msg)

-- get directory name by number for a specific user
User:getPhoneDirectoryName(phone)

User:phoneHangUp()

-- call a phone number
-- return true if the communication is established
User:phoneCall(phone)

-- send smspos to a phone number
-- return true on success
User:sendSMSPos(phone, x,y,z)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_23">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg

-- Send a service alert to all service listeners
--- sender: user or nil (optional, if not nil, it is a call request alert)
--- service_name: service name
--- x,y,z: coordinates
--- msg: alert message
Phone:sendServiceAlert(sender,service_name,x,y,z,msg)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_10">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua"></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_17">Menu</h4>
<div class="sect4">
<h5 id="_phone_2">phone</h5>
<div class="paragraph">
<p>Phone menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_phone_directory">phone.directory</h5>
<div class="paragraph">
<p>Phone directory sub-menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_phone_directory_entry">phone.directory.entry</h5>
<div class="paragraph">
<p>Phone directory entry sub-menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
phone
</td>
<td class="hdlist2">
<p>phone number</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_phone_sms">phone.sms</h5>
<div class="paragraph">
<p>Phone sms sub-menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_phone_service">phone.service</h5>
<div class="paragraph">
<p>Phone service sub-menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_phone_announce">phone.announce</h5>
<div class="paragraph">
<p>Phone announce sub-menu.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_playerstate">PlayerState</h3>
<div class="paragraph">
<p>This module handles the player/character state (customization, weapons, health, armour&#8230;&#8203;).</p>
</div>
<div class="sect3">
<h4 id="_extension_26">Extension</h4>
<div class="sect4">
<h5 id="_user_16">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.state</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_24">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerStateLoaded(user)</code>
</td>
<td class="hdlist2">
<p>called when the player state loading is finished</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerStateUpdate(user, state)</code>
</td>
<td class="hdlist2">
<p>called when the player state is updated (<code>state</code> read-only, partial update, per property)</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_client_11">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.state_ready

-- WEAPONS

-- get player weapons
-- return map of name =&gt; {.ammo}
PlayerState:getWeapons()

-- replace weapons (combination of getWeapons and giveWeapons)
-- weapons: map of name =&gt; {.ammo}
--- ammo: (optional)
-- return previous weapons
PlayerState:replaceWeapons(weapons)

-- weapons: map of name =&gt; {.ammo}
--- ammo: (optional)
PlayerState:giveWeapons(weapons, clear_before)

-- set player armour (0-100)
PlayerState:setArmour(amount)

PlayerState:getArmour()

-- amount: 100-200 ?
PlayerState:setHealth(amount)

PlayerState:getHealth()

-- PLAYER CUSTOMIZATION

-- get number of drawables for a specific part
PlayerState:getDrawables(part)

-- get number of textures for a specific part and drawable
PlayerState:getDrawableTextures(part,drawable)

-- get player skin customization
-- return custom parts
PlayerState:getCustomization()

-- set partial customization (only what is set is changed)
-- custom: indexed customization parts ("foo:arg1:arg2...")
--- "modelhash": number, model hash
--- or "model": string, model name
--- "drawable:&lt;index&gt;": {drawable,texture,palette} ped components
--- "prop:&lt;index&gt;": {prop_index, prop_texture}
--- "hair_color": {primary, secondary}
--- "overlay:&lt;index&gt;": {overlay_index, primary color, secondary color, opacity}
PlayerState:setCustomization(custom)

-- TUNNEL

PlayerState.tunnel.getWeapons = PlayerState.getWeapons
PlayerState.tunnel.replaceWeapons = PlayerState.replaceWeapons
PlayerState.tunnel.giveWeapons = PlayerState.giveWeapons
PlayerState.tunnel.setArmour = PlayerState.setArmour
PlayerState.tunnel.getArmour = PlayerState.getArmour
PlayerState.tunnel.setHealth = PlayerState.setHealth
PlayerState.tunnel.getHealth = PlayerState.getHealth
PlayerState.tunnel.getDrawables = PlayerState.getDrawables
PlayerState.tunnel.getDrawableTextures = PlayerState.getDrawableTextures
PlayerState.tunnel.getCustomization = PlayerState.getCustomization
PlayerState.tunnel.setCustomization = PlayerState.setCustomization</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
(sync) <code>playerModelSave</code>
</td>
<td class="hdlist2">
<p>called before the player model is changed (can be used to save some native player data)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(sync) <code>playerModelRestore</code>
</td>
<td class="hdlist2">
<p>called after the player model is changed (can be used to restore some native player data)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_6">Item</h4>
<div class="sect4">
<h5 id="_wbody">wbody</h5>
<div class="paragraph">
<p>Weapon body.</p>
</div>
<div class="paragraph">
<p><code>wbody|&lt;weapon&gt;</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
weapon
</td>
<td class="hdlist2">
<p>native weapon name</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>wbody|WEAPON_PISTOL</code>
</td>
<td class="hdlist2">
<p>pistol body</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_wammo">wammo</h5>
<div class="paragraph">
<p>Weapon ammunition.</p>
</div>
<div class="paragraph">
<p><code>wammo|&lt;weapon&gt;[|&lt;amount&gt;]</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
weapon
</td>
<td class="hdlist2">
<p>native weapon name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
amount
</td>
<td class="hdlist2">
<p>(optional) ammo amount (ammo box)</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<div class="title">Example</div>
<table>
<tr>
<td class="hdlist1">
<code>wammo|WEAPON_PISTOL</code>
</td>
<td class="hdlist2">
<p>pistol ammo</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>wammo|WEAPON_PISTOL|50</code>
</td>
<td class="hdlist2">
<p>pistol ammo box x50</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_police">Police</h3>
<div class="paragraph">
<p>This module adds some police features.</p>
</div>
<div class="sect3">
<h4 id="_extension_27">Extension</h4>
<div class="sect4">
<h5 id="_user_17">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.police_records -- list of strings

-- insert a police record (will do a save)
--- record: text for one line (html)
User:insertPoliceRecord(record)

User:savePoliceRecords()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_25">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.wantedlvl_users -- map of user =&gt; wanted level

Police:getUserWantedLevel(user)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_12">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.handcuffed -- flag
self.cop -- flag
self.wanted_level
self.current_jail
self.follow_player

-- set player as cop (true or false)
Police:setCop(flag)

-- HANDCUFF

Police:toggleHandcuff()

Police:setHandcuffed(flag)

Police:isHandcuffed()

Police:putInNearestVehicleAsPassenger(radius)

-- FOLLOW

-- follow another player
-- player: nil to disable
Police:followPlayer(player)

-- return player or nil if not following anyone
Police:getFollowedPlayer()

-- JAIL

-- jail the player in a no-top no-bottom cylinder
Police:jail(x,y,z,radius)

-- unjail the player
Police:unjail()

Police:isJailed()

-- WANTED

Police:applyWantedLevel(new_wanted)

-- TUNNEL

Police.tunnel.setCop = Police.setCop
Police.tunnel.toggleHandcuff = Police.toggleHandcuff
Police.tunnel.setHandcuffed = Police.setHandcuffed
Police.tunnel.isHandcuffed = Police.isHandcuffed
Police.tunnel.putInNearestVehicleAsPassenger = Police.putInNearestVehicleAsPassenger
Police.tunnel.followPlayer = Police.followPlayer
Police.tunnel.getFollowedPlayer = Police.getFollowedPlayer
Police.tunnel.jail = Police.jail
Police.tunnel.unjail = Police.unjail
Police.tunnel.isJailed = Police.isJailed
Police.tunnel.applyWantedLevel = Police.applyWantedLevel</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_18">Menu</h4>
<div class="sect4">
<h5 id="_police_2">police</h5>
<div class="paragraph">
<p>Police menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_police_fine">police.fine</h5>
<div class="paragraph">
<p>Police fine sub-menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
tuser
</td>
<td class="hdlist2">
<p>target user</p>
</td>
</tr>
<tr>
<td class="hdlist1">
money
</td>
<td class="hdlist2">
<p>target maximum available money</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_police_check">police.check</h5>
<div class="paragraph">
<p>Police check report menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
tuser
</td>
<td class="hdlist2">
<p>target user</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_police_pc">police_pc</h5>
<div class="paragraph">
<p>Police PC menu.</p>
</div>
</div>
<div class="sect4">
<h5 id="_police_pc_records">police_pc.records</h5>
<div class="paragraph">
<p>Police PC records sub-menu. Manage police records of a character.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
tuser
</td>
<td class="hdlist2">
<p>target user</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_7">Item</h4>
<div class="sect4">
<h5 id="_bulletproof_vest">bulletproof_vest</h5>
<div class="paragraph">
<p>Bulletproof vest, set maximum armour when used.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_radio_2">Radio</h3>
<div class="paragraph">
<p>This module adds groups radio (voice and GPS signal).</p>
</div>
<div class="sect3">
<h4 id="_extension_28">Extension</h4>
<div class="sect4">
<h5 id="_user_18">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">User:connectRadio()

User:disconnectRadio()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_26">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_13">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.talking

self.players -- radio players, map of player server id =&gt; {.group, .group_title, .title}</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>radioSpeakingChange(speaking)</code>
</td>
<td class="hdlist2">
<p>called when radio speaking state changes</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_shop">Shop</h3>
<div class="paragraph">
<p>This module adds item shops.</p>
</div>
<div class="sect3">
<h4 id="_extension_29">Extension</h4>
<div class="sect4">
<h5 id="_server_27">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_19">Menu</h4>
<div class="sect4">
<h5 id="_shop_2">shop</h5>
<div class="paragraph">
<p>Shop menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
type
</td>
<td class="hdlist2">
<p>shop type</p>
</td>
</tr>
<tr>
<td class="hdlist1">
items
</td>
<td class="hdlist2">
<p>shop type table</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_skinshop">SkinShop</h3>
<div class="paragraph">
<p>This module adds skin shops.</p>
</div>
<div class="sect3">
<h4 id="_extension_30">Extension</h4>
<div class="sect4">
<h5 id="_server_28">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_20">Menu</h4>
<div class="sect4">
<h5 id="_skinshop_2">skinshop</h5>
<div class="paragraph">
<p>Skinshop menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
parts
</td>
<td class="hdlist2">
<p>skinshop config parts</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_skinshop_part">skinshop.part</h5>
<div class="paragraph">
<p>Shinshop part sub-menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
title
</td>
<td class="hdlist2">
<p>part title</p>
</td>
</tr>
<tr>
<td class="hdlist1">
part
</td>
<td class="hdlist2">
<p>part name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
custom
</td>
<td class="hdlist2">
<p>current skinshop customization state</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_survival">Survival</h3>
<div class="paragraph">
<p>This module adds survival features.</p>
</div>
<div class="ulist">
<div class="title">Base vitals</div>
<ul>
<li>
<p>food</p>
</li>
<li>
<p>water</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_extension_31">Extension</h4>
<div class="sect4">
<h5 id="_user_19">User</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cdata.vitals -- map of name =&gt; value

-- return vital value (0-1) or nil
User:getVital(name)

-- set vital
-- value: 0-1
User:setVital(name, value)

User:varyVital(name, value)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_29">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.vitals -- registered vitals, map of name =&gt; {default_value}</code></pre>
</div>
</div>
<div class="hdlist">
<div class="title">Events</div>
<table>
<tr>
<td class="hdlist1">
<code>playerVitalChange(user, name)</code>
</td>
<td class="hdlist2">
<p>called when a player vital value changes</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>playerVitalOverflow(user, name, overflow)</code>
</td>
<td class="hdlist2">
<p>called when a player vital overflows (overflow can be negative or positive)</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_client_14">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.in_coma -- flag
self.coma_left -- seconds

Survival:varyHealth(variation)

Survival:setFriendlyFire(flag)

Survival:setPolice(flag)

-- COMA SYSTEM

Survival:isInComa()

-- kill the player if in coma
Survival:killComa()

-- TUNNEL

Survival.tunnel.isInComa = Survival.isInComa
Survival.tunnel.killComa = Survival.killComa
Survival.tunnel.setFriendlyFire = Survival.setFriendlyFire
Survival.tunnel.setPolice = Survival.setPolice
Survival.tunnel.varyHealth = Survival.varyHealth</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_8">Item</h4>
<div class="sect4">
<h5 id="_medkit">medkit</h5>
<div class="paragraph">
<p>Item used to reanimate people in coma.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transformer_2">Transformer</h3>
<div class="paragraph">
<p>This module adds transformers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it&#8217;s a generic system to transform (generate, process, convert) items/money/etc to items/money/etc in a specific area</p>
</li>
<li>
<p>each transformer can take things to generate other things, using a unit of work</p>
</li>
<li>
<p>units are regenerated periodically at a specific rate</p>
</li>
<li>
<p>reagents &#8658; products (ex: reagents can be nothing to create an harvest transformer)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_extension_32">Extension</h4>
<div class="sect4">
<h5 id="_transformer_3">Transformer</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.id
self.cfg
self.units
self.users -- map of user =&gt; recipe name

Transformer:unbindUser(user)

Transformer:bindUser(user, recipe_name)

Transformer:unbindAll()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_server_30">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg
self.transformers -- map of id =&gt; transformer
self.processors -- registered processors, map of id =&gt; {on_display, on_check, on_process}

-- register a transformer processor
-- on_display(user, reagents, products): should return r_info, p_info (two html strings to display info about the reagents and products)
-- on_check(user, reagents, products): should return true if the processing can occur
-- on_process(user, reagents, products): should process the transformation
-- for the three callbacks:
--- reagents: reagents data, can be nil
--- products: products data, can be nil
Transformer:registerProcessor(id, on_display, on_check, on_process)

-- add a transformer
-- id: transformer identitifer (string)
-- cfg: transformer config
--- title
--- color {r,g,b} (255)
--- max_units
--- units_per_minute
--- pos {x,y,z}
--- radius,height (area properties)
--- permissions: (optional)
--- recipes: map of recipe name =&gt; recipe {}
---- description (html)
---- reagents: map of processor id =&gt; data, see modules transformer processors
---- products: map of processor id =&gt; data, see modules transformer processors
---- permissions: (optional) recipe permissions
---- onstart(transformer, user, recipe_name): (optional) called when the recipe starts
---- onstep(transformer, user, recipe_name): (optional) called at each recipe step
---- onstop(transformer, user, recipe_name): (optional) called when the recipe stops
Transformer:set(id, cfg)

-- remove a transformer
Transformer:remove(id)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_menu_21">Menu</h4>
<div class="sect4">
<h5 id="_transformer_4">transformer</h5>
<div class="paragraph">
<p>Transformer menu.</p>
</div>
<div class="hdlist">
<div class="title">data</div>
<table>
<tr>
<td class="hdlist1">
transformer
</td>
<td class="hdlist2">
<p>transformer instance</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vehblacklist">VehBlacklist</h3>
<div class="paragraph">
<p>This module adds a vehicle blacklist (remove vehicles from the game).</p>
</div>
<div class="sect3">
<h4 id="_extension_33">Extension</h4>
<div class="sect4">
<h5 id="_server_31">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_client_15">Client</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.veh_models -- map of model hash
self.interval</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_warp">Warp</h3>
<div class="paragraph">
<p>This module spawns warp points for player/vehicle teleportation.</p>
</div>
<div class="sect3">
<h4 id="_extension_34">Extension</h4>
<div class="sect4">
<h5 id="_server_32">Server</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-lua hljs" data-lang="lua">self.cfg</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_map_entity_3">Map entity</h4>
<div class="sect4">
<h5 id="_warp_2">Warp</h5>
<div class="paragraph">
<p>Default animated entity for the warp module.
Inherits from <code>Map.PosEntity</code>.</p>
</div>
<div class="hdlist">
<div class="title">config</div>
<table>
<tr>
<td class="hdlist1">
color
</td>
<td class="hdlist2">
<p>(optional) <code>{r,g,b,a}</code> marker color</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-05-16 22:58:20 +0200
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</body>
</html>